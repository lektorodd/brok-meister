<!DOCTYPE html>
<html lang="nn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Br√∏k-meister</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            touch-action: manipulation; /* Forbedrer respons p√• mobil */
        }
        .card {
            background-color: #1f2937; /* dark gray */
            border-radius: 1.5rem;
            padding: 2rem;
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            transform: scale(1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .btn {
            transition: all 0.2s ease-in-out;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .answer-btn.correct {
            background-color: #22c55e !important; /* green-500 */
            border-color: #16a34a !important;
            transform: scale(1.05);
        }
        .answer-btn.incorrect {
            background-color: #ef4444 !important; /* red-500 */
            border-color: #dc2626 !important;
            opacity: 0.7;
        }
        .progress-bar-inner {
            transition: width 0.5s ease-out;
        }
        /* Animasjon for poeng */
        @keyframes pop-in {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }
        .pop-in {
            animation: pop-in 0.3s ease-out forwards;
        }
        /* STYLING FOR BR√òKAR */
        .fraction {
            display: inline-block;
            vertical-align: middle;
            margin: 0 0.2em;
            text-align: center;
        }
        .fraction > sup, .fraction > sub {
            display: block;
            font-size: 0.8em;
            line-height: 1;
        }
        .fraction > sup {
            border-bottom: 1px solid currentColor;
            padding-bottom: 2px;
        }
        .fraction > sub {
            padding-top: 2px;
        }
        /* NY STYLING FOR LANG SP√òRSM√ÖLSTEKST */
        .question-text-long {
            font-size: 1.5rem; /* tilsvarer text-2xl */
        }
        /* Footer styling */
        .footer {
            font-family: 'JetBrains Mono', monospace;
        }
        /* Spr√•kveljar */
        .lang-switcher {
            position: absolute;
            top: 1.5rem;
            left: 1.5rem;
            display: flex;
            gap: 0.75rem;
            background-color: rgba(31, 41, 55, 0.5);
            padding: 0.5rem;
            border-radius: 9999px;
        }
        .lang-btn {
            cursor: pointer;
            font-size: 1.5rem;
            opacity: 0.5;
            transition: all 0.2s ease;
        }
        .lang-btn:hover {
            opacity: 1;
            transform: scale(1.1);
        }
        .lang-btn.active {
            opacity: 1;
        }
    </style>
</head>
<body class="bg-gray-900 text-white flex flex-col items-center justify-center min-h-screen p-4">

    <div class="lang-switcher">
        <span class="lang-btn active" data-lang="nn">üá≥üá¥</span>
        <span class="lang-btn" data-lang="es">üá™üá∏</span>
        <span class="lang-btn" data-lang="fr">üá´üá∑</span>
    </div>

    <div id="game-container" class="w-full max-w-2xl mx-auto">

        <!-- Startskjerm -->
        <div id="start-screen" class="card text-center">
            <h1 id="main-title" class="text-5xl font-bold text-cyan-400 mb-4">Br√∏k-meister</h1>
            <p id="start-desc" class="text-lg text-gray-300 mb-8">Test br√∏keigenskapane dine i 10 oppg√•ver med aukande vanskegrad!</p>
            <button id="start-btn" class="btn bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-3 px-8 rounded-full text-xl shadow-lg">Start Spel</button>
        </div>

        <!-- Spelskjerm -->
        <div id="game-screen" class="hidden">
            <!-- Header med info -->
            <div class="flex justify-between items-center mb-4 text-gray-300">
                <div>
                    <span id="score-label" class="font-bold text-lg">Poeng:</span>
                    <span id="score" class="font-bold text-xl text-cyan-400">0</span>
                </div>
                <div class="text-center">
                    <span id="question-counter" class="text-lg">Sp√∏rsm√•l 1 / 10</span>
                </div>
                <div>
                    <span id="streak-label" class="font-bold text-lg">Streak: üî•</span>
                    <span id="streak" class="font-bold text-xl text-amber-400">0</span>
                </div>
            </div>

            <!-- Progresjonsbar -->
            <div class="w-full bg-gray-700 rounded-full h-4 mb-6 shadow-inner">
                <div id="progress-bar" class="bg-cyan-500 h-4 rounded-full progress-bar-inner" style="width: 0%"></div>
            </div>

            <!-- Sp√∏rsm√•l og svar -->
            <div class="card">
                <h2 id="question-text" class="text-2xl md:text-3xl font-semibold mb-8 text-center min-h-[100px] flex items-center justify-center">Lastar sp√∏rsm√•l...</h2>
                <div id="answer-buttons" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- Svaralternativ blir genererte her -->
                </div>
            </div>
        </div>

        <!-- Sluttskjerm -->
        <div id="end-screen" class="hidden card text-center">
            <h2 id="end-title" class="text-4xl font-bold mb-2">Spelet er over!</h2>
            <p class="text-2xl font-semibold text-cyan-400 mb-4" id="final-title">Du er ein br√∏k-meister!</p>
            <div class="bg-gray-800 p-6 rounded-xl mb-8 shadow-inner">
                <p id="final-score-label" class="text-xl mb-2">Poengsummen din:</p>
                <p id="final-score" class="text-6xl font-bold text-amber-400 mb-4">0</p>
                <p id="final-streak-label" class="text-lg">H√∏gaste streak: <span id="final-streak" class="font-bold">0</span>üî•</p>
            </div>
            <button id="restart-btn" class="btn bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-3 px-8 rounded-full text-xl shadow-lg">Spel Igjen</button>
        </div>

    </div>

    <footer class="footer text-center text-gray-500 text-sm mt-8 pb-4">
        <a href="https://www.lektorodd.no" target="_blank" class="underline hover:text-cyan-400">lektorodd</a>
    </footer>

    <script>
        // --- DATA FOR OMSETJINGAR ---
        const translations = {
            'nn': {
                // UI
                docTitle: "Br√∏k-meister",
                mainTitle: "Br√∏k-meister",
                startDesc: "Test br√∏keigenskapane dine i 10 oppg√•ver med aukande vanskegrad!",
                startBtn: "Start Spel",
                scoreLabel: "Poeng:",
                streakLabel: "Streak: üî•",
                questionLabel: "Sp√∏rsm√•l",
                endTitle: "Spelet er over!",
                finalScoreLabel: "Poengsummen din:",
                finalStreakLabel: "H√∏gaste streak:",
                restartBtn: "Spel Igjen",
                // Titlar
                titleMaster: "Gratulerer, du er ein br√∏k-meister!",
                titleExpert: "Imponerande! Du er ein br√∏k-ekspert!",
                titleApprentice: "Godt fors√∏k! Du er ein br√∏k-l√¶rling.",
                // Sp√∏rsm√•l
                questions: [
                    // Kategori: Enkel
                    { question: "I ein br√∏k, kva heiter talet OVER br√∏kstreken?", options: ["Nemnar", "Teljar", "Sum", "Strek"], answer: 1, difficulty: 'enkel' },
                    { question: "Kva for ein br√∏k er lik br√∏k(1,2)?", options: ["br√∏k(2,3)", "br√∏k(3,4)", "br√∏k(4,8)", "br√∏k(1,3)"], answer: 2, difficulty: 'enkel' },
                    { question: "Kva er br√∏k(1,3) + br√∏k(1,3)?", options: ["br√∏k(2,6)", "br√∏k(1,9)", "br√∏k(2,3)", "br√∏k(1,3)"], answer: 2, difficulty: 'enkel' },
                    { question: "Kva er br√∏k(3,5) - br√∏k(1,5)?", options: ["br√∏k(2,5)", "2/0", "br√∏k(4,5)", "br√∏k(1,5)"], answer: 0, difficulty: 'enkel' },
                    { question: "Kva for ein br√∏k er st√∏rst: br√∏k(1,4) eller br√∏k(3,4)?", options: ["br√∏k(1,4)", "br√∏k(3,4)", "Dei er like store", "Umogleg √• seie"], answer: 1, difficulty: 'enkel' },
                    { question: "Kva er br√∏k(1,2) av 10?", options: ["2", "10", "5", "20"], answer: 2, difficulty: 'enkel' },
                    { question: "Kva er br√∏ken br√∏k(10,15) forenkla?", options: ["br√∏k(1,2)", "br√∏k(2,3)", "br√∏k(5,3)", "br√∏k(1,5)"], answer: 1, difficulty: 'enkel' },
                    { question: "Gjer om 2 og br√∏k(1,3) til uekte br√∏k.", options: ["br√∏k(7,3)", "br√∏k(2,3)", "br√∏k(3,2)", "br√∏k(6,3)"], answer: 0, difficulty: 'enkel' },
                    { question: "Rekn ut: br√∏k(1,2) + br√∏k(1,4)", options: ["br√∏k(2,6)", "br√∏k(1,8)", "br√∏k(3,4)", "br√∏k(1,4)"], answer: 2, difficulty: 'enkel' },
                    { question: "Kva er 2 * br√∏k(1,5)?", options: ["br√∏k(2,10)", "br√∏k(1,10)", "br√∏k(3,5)", "br√∏k(2,5)"], answer: 3, difficulty: 'enkel' },
                    { question: "Kva er nemnaren i br√∏ken br√∏k(5,8)?", options: ["5", "8", "13", "3"], answer: 1, difficulty: 'enkel' },
                    { question: "Kva er 1 - br√∏k(1,4)?", options: ["br√∏k(3,4)", "br√∏k(0,4)", "1", "br√∏k(4,3)"], answer: 0, difficulty: 'enkel' },
                    { question: "Forenkla br√∏ken br√∏k(6,9).", options: ["br√∏k(1,3)", "br√∏k(3,2)", "br√∏k(2,3)", "br√∏k(6,9)"], answer: 2, difficulty: 'enkel' },
                    { question: "Kva er br√∏k(4,7) + br√∏k(2,7)?", options: ["br√∏k(6,14)", "br√∏k(6,7)", "br√∏k(2,7)", "br√∏k(8,49)"], answer: 1, difficulty: 'enkel' },
                    { question: "Gjer om br√∏ken br√∏k(5,2) til blanda tal.", options: ["2 og br√∏k(1,2)", "1 og br√∏k(3,2)", "5 og br√∏k(1,2)", "3 og br√∏k(1,2)"], answer: 0, difficulty: 'enkel' },
                    { question: "Kva for ein br√∏k er minst: br√∏k(1,5) eller br√∏k(1,8)?", options: ["br√∏k(1,5)", "Dei er like", "br√∏k(1,8)", "Umogleg √• seie"], answer: 2, difficulty: 'enkel' },

                    // Kategori: Middels
                    { question: "Kva er br√∏ken br√∏k(84,108) forenkla?", options: ["br√∏k(21,27)", "br√∏k(7,9)", "br√∏k(42,54)", "br√∏k(7,12)"], answer: 1, difficulty: 'middels' },
                    { question: "Kva for eit symbol (<, >, =) skal st√• mellom br√∏k(5,6) og br√∏k(7,9)?", options: [">", "<", "=", "Umogleg √• seie"], answer: 0, difficulty: 'middels' },
                    { question: "Rekn ut: br√∏k(3,4) - br√∏k(2,5) + br√∏k(1,2)", options: ["br√∏k(17,20)", "br√∏k(2,1)", "br√∏k(7,20)", "br√∏k(13,20)"], answer: 0, difficulty: 'middels' },
                    { question: "Rekn ut: 5 * br√∏k(3,8)", options: ["br√∏k(15,40)", "br√∏k(3,40)", "br√∏k(15,8)", "br√∏k(8,15)"], answer: 2, difficulty: 'middels' },
                    { question: "Kva blir resultatet av br√∏k(5,9) : br√∏k(2,3)?", options: ["br√∏k(10,27)", "br√∏k(5,6)", "br√∏k(6,5)", "br√∏k(27,10)"], answer: 1, difficulty: 'middels' },
                    { question: "Gjer om 4 og br√∏k(2,7) til uekte br√∏k.", options: ["br√∏k(8,7)", "br√∏k(28,7)", "br√∏k(30,7)", "br√∏k(42,7)"], answer: 2, difficulty: 'middels' },
                    { question: "Ein klasse har 28 elevar. br√∏k(3,7) er gutar. Kor mange jenter er det?", options: ["12", "16", "7", "21"], answer: 1, difficulty: 'middels' },
                    { question: "Kva er br√∏k(3,4) av 200?", options: ["100", "50", "150", "250"], answer: 2, difficulty: 'middels' },
                    { question: "Gjer om den uekte br√∏ken br√∏k(17,5) til blanda tal.", options: ["2 og br√∏k(3,5)", "3 og br√∏k(2,5)", "4 og br√∏k(1,5)", "5 og br√∏k(2,5)"], answer: 1, difficulty: 'middels' },
                    { question: "Rekn ut: br√∏k(2,3) + br√∏k(1,6)", options: ["br√∏k(3,9)", "br√∏k(5,6)", "br√∏k(3,6)", "br√∏k(2,18)"], answer: 1, difficulty: 'middels' },
                    { question: "Kva er br√∏k(3,4) * br√∏k(2,5)?", options: ["br√∏k(6,20)", "br√∏k(5,9)", "br√∏k(3,10)", "br√∏k(6,9)"], answer: 2, difficulty: 'middels' },
                    { question: "Ein sjokolade har 12 ruter. Du et br√∏k(1,4). Kor mange ruter et du?", options: ["3", "4", "6", "1"], answer: 0, difficulty: 'middels' },
                    { question: "Rekn ut: br√∏k(5,8) - br√∏k(1,4)", options: ["br√∏k(4,4)", "br√∏k(3,8)", "br√∏k(4,8)", "br√∏k(1,2)"], answer: 1, difficulty: 'middels' },
                    { question: "Sorter fr√• minst til st√∏rst: br√∏k(1,2), br√∏k(3,8), br√∏k(2,5)", options: ["1/2, 3/8, 2/5", "3/8, 2/5, 1/2", "2/5, 1/2, 3/8", "3/8, 1/2, 2/5"], answer: 1, difficulty: 'middels' },
                    { question: "Gjer om 3 og br√∏k(3,4) til uekte br√∏k.", options: ["br√∏k(9,4)", "br√∏k(12,4)", "br√∏k(15,4)", "br√∏k(10,4)"], answer: 2, difficulty: 'middels' },

                    // Kategori: Vanskelig
                    { question: "Rekn ut: (br√∏k(1,2) + br√∏k(1,3)) * br√∏k(6,5)", options: ["1", "br√∏k(11,10)", "br√∏k(7,5)", "br√∏k(6,10)"], answer: 0, difficulty: 'vanskelig' },
                    { question: "Ein bil har k√∏yrt br√∏k(3,5) av 450 km. Kor mange km st√•r att?", options: ["270 km", "90 km", "180 km", "300 km"], answer: 2, difficulty: 'vanskelig' },
                    { question: "L√∏ys likninga for x: br√∏k(x,3) + 5 = br√∏k(1,2)", options: ["x = -br√∏k(27,2)", "x = -13.5", "x = br√∏k(33,2)", "x = -9"], answer: 1, difficulty: 'vanskelig' },
                    { question: "Kva er verdien av br√∏k(1 + br√∏k(1,4), 1 - br√∏k(1,4))?", options: ["br√∏k(5,3)", "1", "br√∏k(3,5)", "0"], answer: 0, difficulty: 'vanskelig' },
                    { question: "Rekn ut: ( br√∏k(2,3) : br√∏k(1,2) ) - br√∏k(1,3)", options: ["1", "br√∏k(5,6)", "br√∏k(7,6)", "br√∏k(4,3)"], answer: 0, difficulty: 'vanskelig' },
                    { question: "K√•re et br√∏k(1,4) av ein pizza, og Lise et br√∏k(1,3) av det som er att. Kor mykje er att til slutt?", options: ["br√∏k(1,2)", "br√∏k(1,4)", "br√∏k(7,12)", "br√∏k(5,12)"], answer: 0, difficulty: 'vanskelig' },
                    { question: "L√∏ys for x: br√∏k(2x,5) - 1 = br√∏k(x,4)", options: ["x = 5", "x = br√∏k(4,3)", "x = br√∏k(20,3)", "x = 20"], answer: 3, difficulty: 'vanskelig' },
                    { question: "Ein tank blir fylt med br√∏k(3,8) liter per sekund. Kor lang tid tek det √• fylle 12 liter?", options: ["32 sek", "4.5 sek", "24 sek", "36 sek"], answer: 0, difficulty: 'vanskelig' },
                    { question: "Kva er (br√∏k(1,2))¬≥?", options: ["br√∏k(1,6)", "br√∏k(3,2)", "br√∏k(1,8)", "br√∏k(1,5)"], answer: 2, difficulty: 'vanskelig' },
                    { question: "Rekn ut: 5 : (br√∏k(1,2) + br√∏k(1,3))", options: ["6", "12", "br√∏k(5,6)", "30"], answer: 0, difficulty: 'vanskelig' },
                    { question: "Rekn ut: (br√∏k(3,4) - br√∏k(1,3)) : br√∏k(5,6)", options: ["br√∏k(1,2)", "br√∏k(5,24)", "br√∏k(25,72)", "1"], answer: 0, difficulty: 'vanskelig' },
                    { question: "L√∏ys for x: br√∏k(x,2) - br√∏k(x,5) = 3", options: ["x = 6", "x = 10", "x = 15", "x = 5"], answer: 1, difficulty: 'vanskelig' },
                    { question: "Ei flaske inneheld br√∏k(3,4) liter saft. Kor mange glas som rommar br√∏k(1,8) liter kan du fylle?", options: ["4", "5", "6", "8"], answer: 2, difficulty: 'vanskelig' },
                    { question: "Rekn ut: 2 og br√∏k(1,2) * 1 og br√∏k(1,3)", options: ["2 og br√∏k(1,6)", "3 og br√∏k(1,3)", "3 og br√∏k(1,2)", "4"], answer: 2, difficulty: 'vanskelig' },
                    { question: "Ein tredjedel av elevane er gutar. Halvparten av gutane har briller. Kva del av klassen er gutar med briller?", options: ["br√∏k(1,5)", "br√∏k(1,6)", "br√∏k(2,5)", "br√∏k(2,3)"], answer: 1, difficulty: 'vanskelig' },
                    { question: "Kva er verdien av br√∏k(2, 3 - br√∏k(1,2))?", options: ["br√∏k(4,5)", "1", "br√∏k(2,5)", "br√∏k(3,5)"], answer: 0, difficulty: 'vanskelig' },
                ]
            },
            'es': {
                // UI
                docTitle: "Maestro de Fracciones",
                mainTitle: "Maestro de Fracciones",
                startDesc: "¬°Prueba tus habilidades con fracciones en 10 problemas de dificultad creciente!",
                startBtn: "Empezar Juego",
                scoreLabel: "Puntos:",
                streakLabel: "Racha: üî•",
                questionLabel: "Pregunta",
                endTitle: "¬°Juego Terminado!",
                finalScoreLabel: "Tu puntuaci√≥n:",
                finalStreakLabel: "Racha m√°s alta:",
                restartBtn: "Jugar de Nuevo",
                // Titlar
                titleMaster: "¬°Felicidades, eres un maestro de las fracciones!",
                titleExpert: "¬°Impresionante! ¬°Eres un experto en fracciones!",
                titleApprentice: "¬°Buen intento! Eres un aprendiz de fracciones.",
                // Sp√∏rsm√•l
                questions: [
                    // Kategori: Enkel
                    { question: "En una fracci√≥n, ¬øc√≥mo se llama el n√∫mero SOBRE la l√≠nea de fracci√≥n?", options: ["Denominador", "Numerador", "Suma", "L√≠nea"], answer: 1, difficulty: 'enkel' },
                    { question: "¬øQu√© fracci√≥n es igual a br√∏k(1,2)?", options: ["br√∏k(2,3)", "br√∏k(3,4)", "br√∏k(4,8)", "br√∏k(1,3)"], answer: 2, difficulty: 'enkel' },
                    { question: "¬øCu√°nto es br√∏k(1,3) + br√∏k(1,3)?", options: ["br√∏k(2,6)", "br√∏k(1,9)", "br√∏k(2,3)", "br√∏k(1,3)"], answer: 2, difficulty: 'enkel' },
                    { question: "¬øCu√°nto es br√∏k(3,5) - br√∏k(1,5)?", options: ["br√∏k(2,5)", "2/0", "br√∏k(4,5)", "br√∏k(1,5)"], answer: 0, difficulty: 'enkel' },
                    { question: "¬øQu√© fracci√≥n es mayor: br√∏k(1,4) o br√∏k(3,4)?", options: ["br√∏k(1,4)", "br√∏k(3,4)", "Son iguales", "Imposible de decir"], answer: 1, difficulty: 'enkel' },
                    { question: "¬øCu√°nto es br√∏k(1,2) de 10?", options: ["2", "10", "5", "20"], answer: 2, difficulty: 'enkel' },
                    { question: "¬øCu√°l es la fracci√≥n br√∏k(10,15) simplificada?", options: ["br√∏k(1,2)", "br√∏k(2,3)", "br√∏k(5,3)", "br√∏k(1,5)"], answer: 1, difficulty: 'enkel' },
                    { question: "Convierte 2 y br√∏k(1,3) a fracci√≥n impropia.", options: ["br√∏k(7,3)", "br√∏k(2,3)", "br√∏k(3,2)", "br√∏k(6,3)"], answer: 0, difficulty: 'enkel' },
                    { question: "Calcula: br√∏k(1,2) + br√∏k(1,4)", options: ["br√∏k(2,6)", "br√∏k(1,8)", "br√∏k(3,4)", "br√∏k(1,4)"], answer: 2, difficulty: 'enkel' },
                    { question: "¬øCu√°nto es 2 * br√∏k(1,5)?", options: ["br√∏k(2,10)", "br√∏k(1,10)", "br√∏k(3,5)", "br√∏k(2,5)"], answer: 3, difficulty: 'enkel' },
                    
                    // Kategori: Middels
                    { question: "¬øCu√°l es la fracci√≥n br√∏k(84,108) simplificada?", options: ["br√∏k(21,27)", "br√∏k(7,9)", "br√∏k(42,54)", "br√∏k(7,12)"], answer: 1, difficulty: 'middels' },
                    { question: "¬øQu√© s√≠mbolo (<, >, =) debe ir entre br√∏k(5,6) y br√∏k(7,9)?", options: [">", "<", "=", "Imposible de decir"], answer: 0, difficulty: 'middels' },
                    { question: "Calcula: br√∏k(3,4) - br√∏k(2,5) + br√∏k(1,2)", options: ["br√∏k(17,20)", "br√∏k(2,1)", "br√∏k(7,20)", "br√∏k(13,20)"], answer: 0, difficulty: 'middels' },
                    { question: "¬øCu√°l es el resultado de br√∏k(5,9) : br√∏k(2,3)?", options: ["br√∏k(10,27)", "br√∏k(5,6)", "br√∏k(6,5)", "br√∏k(27,10)"], answer: 1, difficulty: 'middels' },
                    { question: "Una clase tiene 28 estudiantes. br√∏k(3,7) son chicos. ¬øCu√°ntas chicas hay?", options: ["12", "16", "7", "21"], answer: 1, difficulty: 'middels' },
                    
                    // Kategori: Vanskelig
                    { question: "Calcula: (br√∏k(1,2) + br√∏k(1,3)) * br√∏k(6,5)", options: ["1", "br√∏k(11,10)", "br√∏k(7,5)", "br√∏k(6,10)"], answer: 0, difficulty: 'vanskelig' },
                    { question: "Un coche ha recorrido br√∏k(3,5) de 450 km. ¬øCu√°ntos km quedan?", options: ["270 km", "90 km", "180 km", "300 km"], answer: 2, difficulty: 'vanskelig' },
                    { question: "Resuelve para x: br√∏k(x,3) + 5 = br√∏k(1,2)", options: ["x = -br√∏k(27,2)", "x = -13.5", "x = br√∏k(33,2)", "x = -9"], answer: 1, difficulty: 'vanskelig' },
                    { question: "¬øCu√°l es el valor de br√∏k(1 + br√∏k(1,4), 1 - br√∏k(1,4))?", options: ["br√∏k(5,3)", "1", "br√∏k(3,5)", "0"], answer: 0, difficulty: 'vanskelig' },
                    { question: "Calcula: ( br√∏k(2,3) : br√∏k(1,2) ) - br√∏k(1,3)", options: ["1", "br√∏k(5,6)", "br√∏k(7,6)", "br√∏k(4,3)"], answer: 0, difficulty: 'vanskelig' },
                ]
            },
            'fr': {
                // UI
                docTitle: "Ma√Ætre des Fractions",
                mainTitle: "Ma√Ætre des Fractions",
                startDesc: "Testez vos comp√©tences en fractions avec 10 probl√®mes de difficult√© croissante !",
                startBtn: "Commencer le Jeu",
                scoreLabel: "Score:",
                streakLabel: "S√©rie: üî•",
                questionLabel: "Question",
                endTitle: "Jeu Termin√© !",
                finalScoreLabel: "Votre score :",
                finalStreakLabel: "Meilleure s√©rie :",
                restartBtn: "Rejouer",
                // Titlar
                titleMaster: "F√©licitations, vous √™tes un ma√Ætre des fractions !",
                titleExpert: "Impressionnant ! Vous √™tes un expert des fractions !",
                titleApprentice: "Bel essai ! Vous √™tes un apprenti des fractions.",
                // Sp√∏rsm√•l
                questions: [
                    // Kategori: Enkel
                    { question: "Dans une fraction, comment s'appelle le nombre AU-DESSUS de la barre de fraction ?", options: ["D√©nominateur", "Num√©rateur", "Somme", "Barre"], answer: 1, difficulty: 'enkel' },
                    { question: "Quelle fraction est √©gale √† br√∏k(1,2) ?", options: ["br√∏k(2,3)", "br√∏k(3,4)", "br√∏k(4,8)", "br√∏k(1,3)"], answer: 2, difficulty: 'enkel' },
                    { question: "Combien font br√∏k(1,3) + br√∏k(1,3) ?", options: ["br√∏k(2,6)", "br√∏k(1,9)", "br√∏k(2,3)", "br√∏k(1,3)"], answer: 2, difficulty: 'enkel' },
                    { question: "Combien font br√∏k(3,5) - br√∏k(1,5) ?", options: ["br√∏k(2,5)", "2/0", "br√∏k(4,5)", "br√∏k(1,5)"], answer: 0, difficulty: 'enkel' },
                    { question: "Quelle fraction est la plus grande : br√∏k(1,4) ou br√∏k(3,4) ?", options: ["br√∏k(1,4)", "br√∏k(3,4)", "Elles sont √©gales", "Impossible √† dire"], answer: 1, difficulty: 'enkel' },
                    { question: "Combien font br√∏k(1,2) de 10 ?", options: ["2", "10", "5", "20"], answer: 2, difficulty: 'enkel' },
                    { question: "Quelle est la fraction br√∏k(10,15) simplifi√©e ?", options: ["br√∏k(1,2)", "br√∏k(2,3)", "br√∏k(5,3)", "br√∏k(1,5)"], answer: 1, difficulty: 'enkel' },
                    { question: "Convertissez 2 et br√∏k(1,3) en fraction impropre.", options: ["br√∏k(7,3)", "br√∏k(2,3)", "br√∏k(3,2)", "br√∏k(6,3)"], answer: 0, difficulty: 'enkel' },
                    
                    // Kategori: Middels
                    { question: "Quelle est la fraction br√∏k(84,108) simplifi√©e ?", options: ["br√∏k(21,27)", "br√∏k(7,9)", "br√∏k(42,54)", "br√∏k(7,12)"], answer: 1, difficulty: 'middels' },
                    { question: "Quel symbole (<, >, =) doit aller entre br√∏k(5,6) et br√∏k(7,9) ?", options: [">", "<", "=", "Impossible √† dire"], answer: 0, difficulty: 'middels' },
                    { question: "Calculez : br√∏k(3,4) - br√∏k(2,5) + br√∏k(1,2)", options: ["br√∏k(17,20)", "br√∏k(2,1)", "br√∏k(7,20)", "br√∏k(13,20)"], answer: 0, difficulty: 'middels' },
                    { question: "Quel est le r√©sultat de br√∏k(5,9) : br√∏k(2,3) ?", options: ["br√∏k(10,27)", "br√∏k(5,6)", "br√∏k(6,5)", "br√∏k(27,10)"], answer: 1, difficulty: 'middels' },
                    { question: "Une classe a 28 √©l√®ves. br√∏k(3,7) sont des gar√ßons. Combien y a-t-il de filles ?", options: ["12", "16", "7", "21"], answer: 1, difficulty: 'middels' },

                    // Kategori: Vanskelig
                    { question: "Calculez : (br√∏k(1,2) + br√∏k(1,3)) * br√∏k(6,5)", options: ["1", "br√∏k(11,10)", "br√∏k(7,5)", "br√∏k(6,10)"], answer: 0, difficulty: 'vanskelig' },
                    { question: "Une voiture a parcouru br√∏k(3,5) de 450 km. Combien de km restent-ils ?", options: ["270 km", "90 km", "180 km", "300 km"], answer: 2, difficulty: 'vanskelig' },
                    { question: "R√©solvez pour x : br√∏k(x,3) + 5 = br√∏k(1,2)", options: ["x = -br√∏k(27,2)", "x = -13.5", "x = br√∏k(33,2)", "x = -9"], answer: 1, difficulty: 'vanskelig' },
                    { question: "Quelle est la valeur de br√∏k(1 + br√∏k(1,4), 1 - br√∏k(1,4)) ?", options: ["br√∏k(5,3)", "1", "br√∏k(3,5)", "0"], answer: 0, difficulty: 'vanskelig' },
                    { question: "Calculez : ( br√∏k(2,3) : br√∏k(1,2) ) - br√∏k(1,3)", options: ["1", "br√∏k(5,6)", "br√∏k(7,6)", "br√∏k(4,3)"], answer: 0, difficulty: 'vanskelig' },
                ]
            }
        };

        let gameQuestions = [];
        let allQuestions = [];
        let currentLanguage = 'nn';

        // --- HENT HTML-ELEMENT ---
        const startScreen = document.getElementById('start-screen');
        const gameScreen = document.getElementById('game-screen');
        const endScreen = document.getElementById('end-screen');
        const startBtn = document.getElementById('start-btn');
        const restartBtn = document.getElementById('restart-btn');
        const scoreEl = document.getElementById('score');
        const streakEl = document.getElementById('streak');
        const questionCounterEl = document.getElementById('question-counter');
        const progressBarEl = document.getElementById('progress-bar');
        const questionTextEl = document.getElementById('question-text');
        const answerButtonsEl = document.getElementById('answer-buttons');
        const finalScoreEl = document.getElementById('final-score');
        const finalStreakEl = document.getElementById('final-streak');
        const finalTitleEl = document.getElementById('final-title');
        // UI-element for omsetjing
        const docTitle = document.querySelector('title');
        const mainTitle = document.getElementById('main-title');
        const startDesc = document.getElementById('start-desc');
        const scoreLabel = document.getElementById('score-label');
        const streakLabel = document.getElementById('streak-label');
        const endTitle = document.getElementById('end-title');
        const finalScoreLabel = document.getElementById('final-score-label');
        const finalStreakLabel = document.getElementById('final-streak-label');
        const langButtons = document.querySelectorAll('.lang-btn');

        // --- SPELVARIABLAR ---
        let currentQuestionIndex, score, streak, highestStreak, questionStartTime;

        // --- FUNKSJONAR ---
        function changeLanguage(lang) {
            currentLanguage = lang;
            const t = translations[lang];
            
            // Oppdater UI-tekst
            docTitle.textContent = t.docTitle;
            mainTitle.textContent = t.mainTitle;
            startDesc.textContent = t.startDesc;
            startBtn.textContent = t.startBtn;
            scoreLabel.textContent = t.scoreLabel;
            streakLabel.innerHTML = t.streakLabel;
            endTitle.textContent = t.endTitle;
            finalScoreLabel.textContent = t.finalScoreLabel;
            finalStreakLabel.innerHTML = t.finalStreakLabel;
            restartBtn.textContent = t.restartBtn;

            // Oppdater aktivt flagg
            langButtons.forEach(btn => {
                btn.classList.toggle('active', btn.dataset.lang === lang);
            });

            // Bytt ut heile sp√∏rsm√•lsbanken
            allQuestions = t.questions;
            
            // Oppdater sluttskjerm-tittel viss den er synleg
            if (!endScreen.classList.contains('hidden')) {
                updateEndGameTitle();
            }
        }

        function formatMathExpressions(text) {
            return text.replace(/br√∏k\((\S+?),(\S+?)\)/g, (match, teller, nevner) => {
                return `<span class="fraction"><sup>${teller}</sup><sub>${nevner}</sub></span>`;
            });
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function startGame() {
            gameQuestions = [];
            
            const easyQuestions = allQuestions.filter(q => q.difficulty === 'enkel');
            const mediumQuestions = allQuestions.filter(q => q.difficulty === 'middels');
            const hardQuestions = allQuestions.filter(q => q.difficulty === 'vanskelig');

            shuffleArray(easyQuestions);
            shuffleArray(mediumQuestions);
            shuffleArray(hardQuestions);

            gameQuestions.push(...easyQuestions.slice(0, 3));
            gameQuestions.push(...mediumQuestions.slice(0, 4));
            gameQuestions.push(...hardQuestions.slice(0, 3));
            
            currentQuestionIndex = 0;
            score = 0;
            streak = 0;
            highestStreak = 0;

            startScreen.classList.add('hidden');
            endScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            
            updateHeader();
            showQuestion();
        }

        function showQuestion() {
            answerButtonsEl.innerHTML = '';
            const currentQuestion = gameQuestions[currentQuestionIndex];

            if (currentQuestion.question.length > 60) {
                questionTextEl.classList.add('question-text-long');
                questionTextEl.classList.remove('md:text-3xl', 'text-2xl');
            } else {
                questionTextEl.classList.remove('question-text-long');
                questionTextEl.classList.add('md:text-3xl', 'text-2xl');
            }

            questionTextEl.innerHTML = formatMathExpressions(currentQuestion.question);
            questionCounterEl.textContent = `${translations[currentLanguage].questionLabel} ${currentQuestionIndex + 1} / ${gameQuestions.length}`;
            
            const progressPercent = ((currentQuestionIndex) / gameQuestions.length) * 100;
            progressBarEl.style.width = `${progressPercent}%`;

            currentQuestion.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.innerHTML = formatMathExpressions(String(option));
                button.classList.add('btn', 'answer-btn', 'w-full', 'p-4', 'text-lg', 'font-semibold', 'rounded-lg', 'bg-gray-700', 'hover:bg-gray-600', 'border-b-4', 'border-gray-800');
                button.addEventListener('click', () => selectAnswer(index));
                answerButtonsEl.appendChild(button);
            });

            questionStartTime = Date.now();
        }

        function selectAnswer(selectedIndex) {
            const timeTaken = (Date.now() - questionStartTime) / 1000;
            const currentQuestion = gameQuestions[currentQuestionIndex];
            const isCorrect = selectedIndex === currentQuestion.answer;

            Array.from(answerButtonsEl.children).forEach(btn => {
                btn.disabled = true;
            });

            if (isCorrect) {
                answerButtonsEl.children[selectedIndex].classList.add('correct');
                let pointsGained = 100;
                
                if (timeTaken < 3) pointsGained += 50;
                else if (timeTaken < 6) pointsGained += 30;
                else if (timeTaken < 10) pointsGained += 10;

                streak++;
                if (streak >= 2) pointsGained += 10 * (streak - 1);
                if (streak > highestStreak) highestStreak = streak;
                score += pointsGained;
            } else {
                answerButtonsEl.children[selectedIndex].classList.add('incorrect');
                answerButtonsEl.children[currentQuestion.answer].classList.add('correct');
                streak = 0;
            }
            
            updateHeader();
            
            setTimeout(() => {
                currentQuestionIndex++;
                if (currentQuestionIndex < gameQuestions.length) {
                    showQuestion();
                } else {
                    endGame();
                }
            }, 1500);
        }

        function updateHeader() {
            scoreEl.textContent = score;
            scoreEl.classList.add('pop-in');
            streakEl.textContent = streak;
            streakEl.classList.add('pop-in');
            setTimeout(() => {
                scoreEl.classList.remove('pop-in');
                streakEl.classList.remove('pop-in');
            }, 300);
        }
        
        function updateEndGameTitle() {
            const t = translations[currentLanguage];
            if (score > 1200) {
                finalTitleEl.textContent = t.titleMaster;
                finalTitleEl.style.color = '#f59e0b';
            } else if (score > 800) {
                finalTitleEl.textContent = t.titleExpert;
                finalTitleEl.style.color = '#67e8f9';
            } else {
                finalTitleEl.textContent = t.titleApprentice;
                finalTitleEl.style.color = '#9ca3af';
            }
        }

        function endGame() {
            gameScreen.classList.add('hidden');
            endScreen.classList.remove('hidden');
            progressBarEl.style.width = '100%';
            finalScoreEl.textContent = score;
            finalStreakEl.textContent = highestStreak;
            updateEndGameTitle();
        }

        // --- EVENT LISTENERS ---
        startBtn.addEventListener('click', startGame);
        restartBtn.addEventListener('click', startGame);
        langButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                changeLanguage(btn.dataset.lang);
            });
        });

        // Initialiser med standardspr√•k
        changeLanguage('nn');

    </script>
</body>
</html>
